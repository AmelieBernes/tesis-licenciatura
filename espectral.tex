\chapter{Estudio espectral}
\label{chap: estudio espectral}


\section{Motivación para realizar un estudio espectral de los PDL}
No es difícil convencerse de que las condiciones de ortogonalidad
impuestas en la definición de la base de discreta de Legendre
$\cali{L}^{n}$
forzan a las entradas de los polinomios discretos $\cali{L}^{n,k}$
a cambiar más frecuentemente de signo conforme aumenta
el grado $k$, luego, conforme $k$ tiende a $n-1$,
la cantidad de oscilaciones aumenta; revisemos, 
por ejemplo, el caso $n=4$.



\begin{minipage}{0.5\textwidth}
\begin{figure}[H]
\includegraphics[scale=0.25]{oscil1}
\end{figure}
\end{minipage} \hfill
\begin{minipage}{0.45\textwidth}
1.- Por definición,
$\mathcal{L}^{4,0}$ se obtiene al normalizar 
al vector constante uno de $\IR^{4}$, o sea, 

\[
\cali{L}^{4,0} = \left(
\frac{1}{2}, \frac{1}{2}, \frac{1}{2}, \frac{1}{2}
\right).
\]
\end{minipage} 


\begin{minipage}{0.5\textwidth}
2.- La señal $\cali{L}^{4,1} \in \IR^{4}$ es un polinomio discreto de
dimensión 4 y grado 1 que se obtiene exigiendo las
siguientes condiciones

\[
\langle \cali{L}^{4,1} , \cali{L}^{4,0} \rangle=0
\hspace{0.2cm} \text{y} \hspace{0.2cm}
\langle \cali{L}^{4,1} , \cali{L}^{4,1} \rangle=1;
\]
esta primera condición se refleja en que 
las alturas de los puntos de la gráfica de 
$\cali{L}^{4,1}$ deben sumar cero;
esto implica un cambio de signo (y sólo uno,
pues el polinomio es lineal).

\end{minipage} \hfill
\begin{minipage}{0.45\textwidth}
\begin{figure}[H]
\includegraphics[scale=0.3]{oscil2}
\end{figure}
\end{minipage}

\noindent
3.- El vector
$\cali{L}^{4,2} \in \IR^{4}$ satisface las siguientes
tres condiciones:

\[
\langle \cali{L}^{4,2} , \cali{L}^{4,0} \rangle=0,
\hspace{0.2cm}
\langle \cali{L}^{4,2} , \cali{L}^{4,1} \rangle=0,
\hspace{0.2cm} \text{y} \hspace{0.2cm}
\langle \cali{L}^{4,2} , \cali{L}^{4,2} \rangle=1;
\]
observe que si las entradas de 
$\cali{L}^{4,2}$ fuesen todas positivas o todas negativas,
entonces no se tendría la ortogonalidad
con la señal constante $\cali{L}^{4,0}$.


\begin{figure}[H]
\includegraphics[scale=0.6]{oscil3}
\end{figure}

4.- Por último, $\cali{L}^{4,3} \in \IR^{4}$ satisface
las siguientes cuatro condiciones: 

\[
\langle \cali{L}^{4,3} , \cali{L}^{4,0} \rangle=0,
\hspace{0.2cm}
\langle \cali{L}^{4,3} , \cali{L}^{4,1} \rangle=0,
\langle \cali{L}^{4,3} , \cali{L}^{4,2} \rangle=0,
\hspace{0.2cm} \text{y} \hspace{0.2cm}
\langle \cali{L}^{4,3} , \cali{L}^{4,3} \rangle=1.
\]

Según los teoremas 
\ref{cor: propiedades importantes de espacios Wi}
y \ref{prop: simetrias en dimensiones pares},
$\cali{L}^{4,3}$ es la discretización de un polinomio
cúbico y además es una señal antisimétrica (en el sentido de la definición
\ref{def: espacios de seniales simetricas y antisimetricas}); dos gráficas de señales que cumplen esto se ilustran abajo:

\begin{figure}[H]
	\includegraphics[scale=0.6]{oscil4}
	\sidecaption{Observe que la señal cúbica de la izquierda tiene
	un sólo cambio de signo, mientras que la de la derecha (que es 
	$\cali{L}^{4,3}$ tiene tres.)}
\end{figure}

La señal cúbica de la izquierda, a pesar de 
ser ortogonal a $\mathcal{L}^{4,0}$ y a $\cali{L}^{4,2}$ por 
simetría (c.f. lema
\ref{lema: ortogonalidad entre sim y antisim}), 
definitivamente no puede ser ortogonal
a $\cali{L}^{4,1}$, pues las entradas de estos dos vectores de 
$\IR^{4}$ tienen el mismo signo. Sin embargo, la señal cúbica 
de la derecha (que de hecho es $\cali{L}^{4,3}$) sí cumple el ser
ortogonal a $\cali{L}^{4,1}$ pero, para lograr esto, sus
entradas deben cambiar de signo tres veces. \\


Estando de acuerdo en que es pertinente realizar un análisis
espectral de los PDL, después de dibujar las gráficas de algunos
de estos para varias dimensiones $n$, proponemos una hipótesis
que relaciona una presencia importante de cierta frecuencia
de oscilación asociada a un PDL.


\begin{figure}[H]
	\sidecaption{
	Aproximando las gráficas
	de $\cali{L}^{60,0}$ y $\cali{L}^{60,1}$
	con sinusoides. 
	\label{fig: hip_0,1}
	}
	\centering
	\includegraphics[scale = 0.6]{hip_0,1} 
\end{figure}	

\begin{figure}[H]
	\sidecaption{
	Aproximando las gráficas
	de $\cali{L}^{60,2}$ y $\cali{L}^{60,3}$
	con sinusoides. 
	\label{fig: hip_2,3}
	}
	\centering
	\includegraphics[scale = 0.6]{hip_2,3} 
\end{figure}	

\begin{figure}[H]
	\sidecaption{
	Aproximando las gráficas
	de $\cali{L}^{60,4}$ y $\cali{L}^{60,5}$
	con sinusoides. 
	\label{fig: hip_4,5}
	}
	\centering
	\includegraphics[scale = 0.6]{hip_4,5} 
\end{figure}	

\begin{hip}
\label{ref: hipotesis}
Sean $n \geq 2$, $0 \leq k \leq n-1$ entero. 
Sea $\cali{L}^{n,k}$ el PDL de dimensión $n$ y grado $k$.
La frecuencia que mejor modela la oscilación de la gráfica
de $\cali{L}^{n,k}$ es $\frac{k}{2}$ 
\end{hip}

Se ha formulado de forma intencional la hipótesis 
\ref{ref: hipotesis} en términos vagos, para tener libertad
después de definir las herramientas con las que abordaremos el problema
de dar forma concreta a la hipótesis y mejorarla o refutarla con simulaciones
numéricas.

\input{apendice_DFT}
\input{coseno_a_plano}


\section{Estudio espectral de los PDL}

Ya podemos usar la base de Fourier real $\cali{F}_{n}$
definida en la proposición \ref{prop: base de fourier version real}
para hacer un estudio espectral de los PDL. \TODO{Grafico
algunos resultados en otro capítulo?} \\


Puesto que, por la construcción de $\cali{F}_{n}$, 
hacer un análisis espectral de una señal $x \in \IR^{n}$
via su análisis respecto a la BON $\cali{F}_{n}$ nos lleva
a considerar sólo ciertas frecuencias enteras
(c.f. nota \ref{nota: frecuencias en las bases de fourier}),
queremos no sólo usar la TDF para realizar
nuestro estudio espectral, pues
no queremos restringirnos
al estudio de frecuencias enteras
(después de todo, según la hipótesis planteada en 
\ref{ref: hipotesis}, 
creemos que la frecuencia que mejor aproxima al PDL
$\cali{L}^{n,k}$ es $\frac{k}{2}$, y este último número no siempre
es un entero), sino que nos gustaría
\begin{enumerate}
	\item poder elegir una frecuencia $\omega \geq 0$ respecto
a la cual comparar a la señal y,
	\item una vez fijada una frecuencia, buscar el desfase $\phi \in [0,1]$
	que mejor ajuste la gráfica de $x$.
\end{enumerate}

\begin{figure}[H]
	\sidecaption{
	Aquí se grafica una misma señal $x \in \IR^{16}$ y se 
	compara con dos sinusoides de frecuencia $3.6$, una con 
	desfase (normalizado) 0.8 y otra con 0.32. Observe que
	la primera parece ajustar mucho mejor la gráfica de $x$.
	\label{fig: ejemplo desfase}
	}
	\centering
	\includegraphics[scale=0.45]{desfase_ejemplo} 
\end{figure}	


Vamos a seguir
una linea de razonamiento totalmente análoga a la empleada 
en el ejemplo \ref{subs: ejm 3}, pues aquí también abordamos el problema
definiendo cúmulos
\sidenote{Hablamos más precisamente
de subespacios de $\IR^{n}$, pero 
\TODO{notación de DS. Habla tamién de esto 
en el ap. de cosine sim.}}
de $\IR^{n}$ que consten de elementos que cumplan
determinada propiedad (en el caso del ejemplo \ref{subs: ejm 3}, la propiedad
era ser elemento de determinado espacio $W_{n,k}$ mientras que 
en esta sección la propiedad de nuestro interés es ``ser la discretización
de un sinusoide de frecuencia $\omega$'') y usando el coseno del ángulo que
una señal $x$ forma con dichos cúmulos para dar una medida de qué tanto
tiene $x$ la propiedad considerada.


usamos el coseno del ángulo que forma una señal $x \in \IR^{n}$
con el plano $W_{n,1}$ para dar una medida de qué tan afín es $x$;
queremos ahora hacer algo similar, y usar el coseno de $x$ con espacios
de frecuencias $\omega >0$ como
una medida de qué tanto reacciona $x$ a la frecuencia $\omega$.



\begin{notacion}
Para simplificar la notación, denotamos por $I_{n}$ al intervalo
$\{ \frac{m}{n}  : 0 \leq m \leq n-1 \}$.
\end{notacion}

Digamos qué es lo que 
entendemos por ``señal de frecuencia pura $\omega$''.

\begin{defi}
Sean $n \in \IN$,  $\omega>0$, $\phi \in [0,1[$.  
A toda señal $n-$dimensional  
de la forma

\begin{equation}
A \left(
cos \left(  2 \pi \omega t + 2 \pi \phi
\right)
\right)_{t \in I_{n}}
\end{equation}

\noindent
con $A \in \IR$, se le llamará
\textbf{señal $n-$dimensional de frecuencia
pura $\omega$}. En este contexto,
a $\phi$ se le llama el \textbf{desfase normalizado}
de la señal, y a $A$ la \textbf{amplitud}.
\end{defi}

\begin{nota}
Observe que toda señal de la forma
\begin{equation*}
A \left(
sin \left(  2 \pi \omega t + 2 \pi \phi
\right)
\right)_{t \in I_{n}},
\end{equation*}
con $A \in \IR$, también es una señal $n-$dimensional
de frecuencia pura $\omega$, pues, como 
\[
sen(x) = - cos (x+ \pi/2) \hspace{0.2cm}
\textit{para toda } x \in \IR,
\]
entonces
\begin{equation*}
A \left(
sin \left(  2 \pi \omega t + 2 \pi \phi
\right)
\right)_{t \in I_{n}} =
-A \left(
cos \left(  2 \pi \omega t + 2 \pi \phi^{'}
\right)
\right)_{t \in I_{n}},
\end{equation*}
donde $\phi^{'}= (\phi + 1/4) \% 1 \in [0,1[$.
\end{nota}


\begin{figure}[H]
	\sidecaption{
	Se grafica a la función 
	$f(t) = cos(2 \pi \cdot \frac{5}{2} t + 2 \pi \cdot 0.3)$;
	muestreando este sinusoide de forma uniforme en el 
	intervalo [0,1] obtenemos una señal de frecuencia pura
	$\omega = \frac{5}{2}$. En la figura, $n=5$.
	\label{fig: muestreo coseno}
	}
	\centering
	\includegraphics[scale= 0.55]{muestreo_coseno} 
\end{figure}	

\begin{prop}
\label{prop: para que frecuencias omega vector seno es cero}
	Sean $n \geq 2$, $\omega \geq 0$.
	\begin{itemize}
		\item El vector 
		\begin{equation}
		\label{eq: coseno omega}
		c_{n, \omega} = \left(cos(2 \pi \omega m/n) \right)_{m=0}^{n-1} \in \IR^{n}
		\end{equation}
		no es cero, y 
		\item el vector 
		\begin{equation}
		\label{eq: seno omega}
		s_{n, \omega} = \left(sen(2 \pi \omega m/n) \right)_{m=0}^{n-1} \in \IR^{n}
		\end{equation}
		es cero si y sólo si $\omega \in \frac{n}{2} \IZ$.
	\end{itemize}
\end{prop}
\noindent
\textbf{Demostración.}
El primer punto es fácil de probar, pues la primera entrada del
vector \eqref{eq: coseno omega} es 
$cos(0)=1$.

Supogamos ahora que $\omega>0$ es tal que \eqref{eq: seno omega}
es el vector cero, o sea, que
para toda $0 \leq m \leq n-1$, se tiene que 
$sen(2 \pi \omega m/n)=0$. En particular, ocurre
$sen(2 \pi \omega /n)=0$; esto implica la igualdad 
$2 \pi \omega /n = \pi K$ para algún entero $K$. Despejando
a $\omega$ de la ecuación tenemos que 
$\omega = \frac{n}{2}K \in \frac{n}{2} \IZ$. Recíprocamente,
todo $\omega$ de la forma 
$\frac{n}{2}K$, con $K \in \IZ$ hace que el vector 
\eqref{eq: seno omega} sea cero, pues, para toda $0 \leq m \leq n-1$,
$sen\left(2 \pi \frac{n}{2}K \frac{m}{n}\right)=
sen((Km)\pi)=0$.
\QEDB
\vspace{0.2cm}


\begin{obs}
\label{obs: f y g son l.i. y de norma uno}
Sean $n \geq 2$ entero, $\omega \geq 0$ con $\omega \not\in \frac{n}{2} \IZ$.
Los vectores \eqref{eq: coseno omega} y \eqref{eq: seno omega}
de $\IR^{n}$ son linealmente independientes.
\end{obs}
\noindent
\textbf{Demostración.}
Sólo note que 
la primera entrada de \eqref{eq: coseno omega} es $1$, mientras que  
la primera entrada de $g_{n, \omega}$ sea cero, pero no
todas sus entradas sean cero (c.f. proposición 
\ref{prop: para que frecuencias omega vector seno es cero}). 
\QEDB
\vspace{0.2cm}


Según la observación 
\ref{obs: f y g son l.i. y de norma uno}, si $\omega \not\in \frac{n}{2} \IZ$,
el espacio $P_{n,\omega}$ que generan los vectores 
\eqref{eq: coseno omega} y \eqref{eq: seno omega}

\begin{align}
\label{eq6: 23Ap}
P_{n,\omega}:= & span(c_{n, \omega}, s_{n, \omega}) \notag  \\  
= &
\{ a \left( cos \left(2 \pi \omega t \right) \right)_{t \in I_{n}} +
b ( sen (2 \pi \omega t ))_{t \in I_{n}} : 
\hspace{0.2cm} a, b \in \IR \},
\hspace{0.1cm} \omega \not\in \frac{n}{2} \IZ
\end{align}

\noindent
es un plano (i.e. un subespacio de dimensión $2$) de $\IR^{n}$.
\begin{prop}
\label{prop: Pw consta de las señales de frecuencia omega}
Sean $n \in \IN$, $\omega \geq 0$ 
con 
$\omega \not\in \frac{n}{2} \IZ$.
El espacio $P_{n, \omega}$ definido en \eqref{eq2: 20Marzo} consta exactamente
de las señales $n$ dimensionales de frecuencia $\omega$.
\end{prop}

\noindent
\textbf{Demostración.}

Sea $\phi \in [0,1]$ un desfase cualquiera y $A \in \IR$
una amplitud cualquiera; por la regla
del coseno de la suma de dos ángulos, tenemos que
\[
A(cos (2 \pi \omega t + 2 \pi \phi))_{t \in I_{n}}
= Aa  (cos(2 \pi \omega t))_{t \in I_{n}} +
Ab  (sen(2 \pi \omega t))_{t \in I_{n}} \in P_{\omega} \in P_{\omega}
\]
donde
\[
a := cos (2 \pi \phi) \hspace{0.2cm} \text{y}
\hspace{0.2cm} b := sin (2 \pi  \phi).
\]


Recíprocamente, si $a, b \in \IR$ son escalares cualesquiera, 
el elemento genérico
$x=  a \left( cos \left(2 \pi \omega t \right) \right)_{t \in I_{n}} +
b ( sen (2 \pi \omega t ))_{t \in I_{n}} $ de $P_{n,w}$ puede
expresarse como sigue:

\begin{equation}
\label{eq1: 28Mar23}
x = \sqrt{a^{2}+b^{2}} \left(
A  \left( cos \left(2 \pi \omega t \right) \right)_{t \in I_{n}} +
B  \left( sin \left(2 \pi \omega t \right) \right)_{t \in I_{n}}
\right),
\end{equation}

\noindent
donde
\[
A := \frac{a}{\sqrt{a^{2}+b^{2}}} \hspace{0.2cm} \text{y} \hspace{0.2cm}
B := \frac{b}{\sqrt{a^{2}+b^{2}}}.
\]
Como $A^{2}+ B^{2}=1$, existe $\phi \in [0,1]$ tal que
\begin{equation}
\label{eq0: 28Mar23}
A = cos (2 \pi \phi) \hspace{0.2cm} \text{y}  \hspace{0.2cm}
B = sin (2 \pi \phi);
\end{equation}
sustituyendo \eqref{eq0: 28Mar23} en \eqref{eq1: 28Mar23}, llegamos
a que

\begin{align*}
x = &  \sqrt{a^{2}+b^{2}} (
cos(2 \pi \phi) \cdot (cos (2 \pi \omega t))_{t \in I_{n}} + 
sin(2 \pi \phi) \cdot (sin (2 \pi \omega t))_{t \in I_{n}} 
) \\
= & \sqrt{a^{2}+b^{2}} (
cos(2 \pi \phi) \cdot cos (2 \pi \omega t) +
sin(2 \pi \phi) \cdot sin (2 \pi \omega t) 
)_{t \in I_{n}}  \\
= &  \sqrt{a^{2}+b^{2}} (
cos (2 \pi \omega t - 2 \pi \phi)
)_{t \in I_{n}}.
\end{align*}

\QEDB
\vspace{0.2cm}


\noindent 
Según la proposición
\ref{prop: Pw consta de las señales de frecuencia omega},
$P_{n, \omega} \subseteq \IR^{n}$ es el plano que consiste de las señales
de dimensión $n$ y frecuencia (pura) $\omega$.

Si $\omega \in \frac{n}{2} \IZ$, entonces, según 
la proposición 
\ref{prop: para que frecuencias omega vector seno es cero}, el vector
$s_{n, \omega}$ es el vector cero y $c_{n, \omega}$, luego, el espacio
\begin{align}
\label{eq0: 23Ap}
P_{n,\omega}:= & span(c_{n, \omega}, s_{n, \omega}) \notag  \\  
= &
\{ a \left( cos \left(2 \pi \omega t \right) \right)_{t \in I_{n}} : 
\hspace{0.2cm} a \in \IR \},
\hspace{0.1cm} \omega \in \frac{n}{2} \IZ
\end{align}
es una recta (i.e. un subespacio de dimensión $1$)
de $\IR^{n}$.

\begin{defi}
Si $n \geq 2$ y $\omega>0$, entonces
al subespacio $P_{n,\omega}$ 
de $\IR^{n}$,
definido en \eqref{eq2: 20Marzo} si 
$\omega \not\in \frac{n}{2} \IZ$ y en 
\eqref{eq0: 23Ap} en caso contrario,
le llamaremos el \textbf{espacio monofrecuencial
$n$ dimensional} de frecuencia $\omega$.
\end{defi}


Es razonable pues
medir la cercanía de una señal $n-$dimensional $x \in \IR^{n}$
a tener frecuencia $\omega$
con el ángulo que $x$ forma con el subespacio $P_{n, \omega}$,
cuyo coseno, según la proposición
\ref{prop: algunos hechos sobre el angulo entre un vector y un subespacio}
es
\begin{equation}
\label{eq0: 20Mar}
cos \left( \measuredangle (x, W) \right) = \frac{|| \Pi_{W}(x) ||}{||x||}
\in [0,1].
\end{equation}


\begin{figure}[H]
	\sidecaption{
	Según la relación \eqref{eq0: 20Mar}, 
	si $\frac{||\Pi_{P_{\omega}}(x)||}{||x||}$ es cercano 
	a uno (resp. a cero), entonces $x$ es muy parecido a una señal de frecuencia $\omega$
	(resp. se aleja de ser una señal de frecuencia $\omega$).
	\label{fig: 20Mar23_1}
	}
	\centering
	\includegraphics[scale= 1]{20Mar23_1} 
\end{figure}	

Si $x$ es unitaria,
tenemos la relación simplificada 

\begin{equation}
\label{eq1: 20Mar}
cos \left( \measuredangle (x, W) \right) = || \Pi_{W}(x) || 
\hspace{0.5cm} (x \hspace{0.1cm} \text{unitario).}
\end{equation}


\textbf{Usaremos pues, para dar una medida de qué tanto
reacciona una señal $x \in \IR^{n}$ a una frecuencia
$\omega >0$
el número 
$\frac{||\Pi_{P_{n, \omega}}(x)||}{||x||} \in [0,1]$.} \\

\TODO{Deberías notar que sólo hay dos espacios P cuando nomega en n medios Z.}

\begin{defi}
\label{def: final de sigmas}
Sean $n \geq 2$, $\omega \geq 0$. 
Definimos la función $\sigma_{n}(\cdot, \omega)$ para todo 
elemento de $\IR^{n} - \{ 0\}$
como sigue;
\begin{equation}
\label{eq: def sigmas}
	\forall x \in \IR^{n}-\{ 0\}: \hspace{0.2cm}
	\sigma_{n}(x, \omega) = \frac{||\Pi_{P_{n, \omega}}(x)||}{||x||} .
\end{equation}
\end{defi}

Así, fijada una frecuencia $\omega$, 
\begin{itemize}
\item si $\sigma_{n, \omega}(x)$ es ``cercano'' a cero, $\omega$ no
es una frecuencia con la que es razonable aproximar a $x$ (pues $x$ será
cercano a ser ortogonal a toda señal de dimensión $n$ y frecuencia 
$\omega$),  mientras que

\item si $\sigma_{n, \omega}(x)$ es ``cercano'' a uno, también es muy cercano
(hablando en términos de distancia euclídea) a su proyección al espacio
$P_{n, \omega}$, luego $x$ es muy parecido a tener frecuencia $\omega$.
\end{itemize}


Para poder usar las fórmulas
derivadas en la sección 
\ref{ap: Caso particular en el que el subespacio en cuestión es un plano},
debemos de dar una base normalizada del espacio $P_{\omega}$.

\begin{prop}
\label{prop: aaa}
Sean $n \in \IN$, $\omega>0$. Sean los vectores $c_{n, \omega}, 
s_{n ,\omega} \in \IR^{n}$ como se definieron en 
\eqref{eq: coseno omega} y \eqref{eq: seno omega}, 
respectivamente.
\begin{itemize}
	\item Si $\omega \not\in \frac{n}{2} \IZ$, entonces 
	$\{ f_{n, \omega}, g_{n, \omega} \}$, donde

	\begin{equation}
	\label{eq5: 19Marzo}
	f_{n, \omega}=\xi_{n, \omega} c_{n, \omega}
	\in \IR^{n}
	\end{equation}
y 

	\begin{equation}
	\label{eq6: 19Marzo}
	g_{n, \omega}= \eta_{n, \omega} s_{n, \omega}
	\in \IR^{n},
	\end{equation}
con 
\begin{equation}
\label{eq7: 19Marzo}
	\xi_{n, \omega}= 
	\sqrt{2} \cdot \left( n + \frac{sen(2 \pi \omega)
	cos(2 \pi \omega \left(\frac{n-1}{n} \right))}{sen \left(2 \pi 
	\frac{\omega}{n} \right)} \right)^{-\frac{1}{2}} 
\end{equation}
y

	\begin{equation}
	\label{eq8: 19Marzo}
	\eta_{n, \omega}= \sqrt{2} \cdot \left( n - \frac{sen(2 \pi \omega)
	cos(2 \pi \omega \left(\frac{n-1}{n} \right))}{sen \left(2 \pi 
	\frac{\omega}{n} \right)} \right)^{-\frac{1}{2}}.
	\end{equation}

\noindent
es una base normalizada del subespacio $P_{n, \omega} \leq \IR^{n}$
definido en \eqref{eq6: 23Ap}, y,
\item si $\omega \in \frac{n}{2} \IZ$, entonces 
$\{ f_{n, \omega} \}$, con
\begin{equation}
\label{ec: 4: 23ap}
	f_{n, \omega} := \frac{1}{\sqrt{n}}c_{n, \omega}
\end{equation}
es una base normalizada 
del subespacio $P_{n, \omega} \leq \IR^{n}$
definido en \eqref{eq0: 23Ap}.
\end{itemize}
\end{prop}
\noindent
\textbf{Demostración.}
En efecto, por definición del espacio
$P_{n, \omega}$, $\{ c_{n, \omega}, s_{n, \omega} \}$
es una base de este cuando
$\omega \not\in \frac{n}{2}\IZ$, y
$\{ c_{n, \omega}\}$ es base si 
$\omega \in \frac{n}{2}\IZ$,
luego, en ambos casos el conjunto propuesto en efecto
es una base de $P_{n, \omega}$.
En el segundo caso, puesto que
$f_{n, \omega}$ será un vector cuyas entradas serán $1$, o $-1$,
\eqref{ec: 4: 23ap} en efecto es un vector unitario. 
En el primer caso, se han calculado las constantes 
$\xi_{n, \omega}$ y $\eta_{n, \omega}$
dadas en 
\eqref{eq7: 19Marzo} y \eqref{eq8: 19Marzo}
para que $f_{n, \omega}$ y $g_{n, \omega}$
tengan normal uno; puesto que los cálculos son muy
similares a los realizados en la demostración de la proposición
\ref{prop: producto punto entre f y g}, los omitimos.
\QEDB
\vspace{0.2cm}


Conviene también establecer una fórmula para
el producto punto entre 
los vectores $f_{n, \omega}$ y $g_{n, \omega}$
definidos en la proposición \ref{prop: aaa}
cuando $\omega \not\in \frac{n}{2} \IZ$.
Hacemos esto a continuación.

\begin{prop}
\label{prop: producto punto entre f y g}
Fijados $n \geq 2$ y $\omega \geq 0$ con 
$\omega \not\in \frac{n}{2}\IZ$, 
el producto punto entre 
los vectores
$f_{n, \omega}$ y $g_{n, \omega}$, definidos 
\eqref{eq5: 19Marzo} y \eqref{eq6: 19Marzo}
respectivamente, es

\begin{equation}
\label{eq9: 19Marzo}
\langle f_{n, \omega} , g_{n, \omega} \rangle =
\frac{\xi_{n, w} \eta_{n, \omega}}{2} \cdot 
\frac{sen(2 \pi \omega)
sen(2 \pi \omega \left( 1- \frac{1}{n} \right))}{sen \left(2 \pi 
\frac{\omega}{n} \right)}
\end{equation}

\end{prop}
\noindent
\textbf{Demostración.}
Aquí usaremos las siguientes tres igualdades:

\begin{equation}
\label{eq10: 19Marzo}
\forall \alpha \in \IR: \hspace{0.2cm}
sen(2 \alpha) = 2 sen(\alpha) cos(\alpha),
\end{equation}



\begin{equation}
\label{eq11: 19Marzo}
\forall z\in \IR: \hspace{0.2cm}
sen(z)= \frac{e^{iz}-e^{-iz}}{2i},
\end{equation}



\begin{equation}
\label{eq12: 19Marzo}
\forall a \in \IR-\{ 1 \}: \hspace{0.2cm}
\suma{m=0}{n-1}{a^{r}}= \frac{1-a^{n}}{1-a}.
\end{equation}

\noindent
Tenemos que

\begin{align*}
\langle f_{n,\omega} , g_{n, \omega} \rangle = &
\xi_{n, \omega} \eta_{n, \omega} \left\langle 
\left( cos \left( 2 \pi \omega \frac{m }{n} \right) \right)_{0 \leq m \leq N-1} ,  
\left( cos \left( 2 \pi \omega \frac{m }{n}\right) \right)_{0 \leq m \leq N-1} \right\rangle \\
= & \xi_{n, \omega} \eta_{n, \omega} \suma{m=0}{n-1}{
cos \left(2 \pi \omega \frac{m}{n}\right) sen\left( 2 \pi \omega \frac{m}{n}\right)} \\
= & \frac{\xi_{n, \omega} \eta_{n, \omega}}{2}
\suma{m=0}{n-1}{
\left( sen\left( 4 \pi \omega \frac{m}{n}\right) \right)} \\
= & \frac{\xi_{n, \omega} \eta_{n, \omega}}{4i} \suma{m=0}{n-1}{
\left( e^{4 \pi \omega i m/n} - 
e^{-4 \pi \omega i m/n} \right) } \\
= & \frac{\xi_{n, \omega} \eta_{n, \omega}}{4i} 
\left(
\frac{1-e^{4 \pi \omega i }}{1-e^{4 \pi \omega i /N}} - 
\frac{1-e^{-4 \pi \omega i }}{1-e^{-4 \pi \omega i /N}} 
\right) \\
= & \frac{\xi_{n, \omega} \eta_{n, \omega}}{4i} 
\left(
\frac{e^{2 \pi \omega i }}{e^{2 \pi \omega i/n }}
\frac{e^{-2 \pi \omega i }-e^{2 \pi \omega i }}{e^{-2 \pi \omega i/n }-e^{2 \pi \omega i /N}} - 
\frac{e^{-2 \pi \omega i }}{e^{-2 \pi \omega i/n }}
\frac{e^{2 \pi \omega i }-e^{-2 \pi \omega i }}{e^{2 \pi \omega i/n }-e^{2 \pi \omega i /N}} 
\right) \\
= & 
\frac{\xi_{n, \omega} \eta_{n, \omega}}{4i} 
\left(
e^{2 \pi \omega i \left( 1-1/n \right)}
\frac{sen(2 \pi \omega)}{sen(2 \pi \omega /n)} - 
e^{-2 \pi \omega i \left( 1-1/n \right)}
\frac{sen(2 \pi \omega)}{sen(2 \pi \omega /n)}
\right) 
\\
= & 
\frac{\xi_{n, \omega} \eta_{n, \omega}}{4i} 
\frac{sen(2 \pi \omega)}{sen(2 \pi \omega /n)}
\left(
e^{2 \pi \omega i \left( 1-1/n \right)} - e^{-2 \pi \omega i \left( 1-1/n \right)}
\right) \\
= &
\frac{\xi_{n, \omega} \eta_{n, \omega}}{4i} 
\frac{sen(2 \pi \omega)}{sen(2 \pi \omega /n)}
\left(
2i \cdot  sen \left( 2 \pi \omega  \left( 1- \frac{1}{n} \right) \right)
\right)\\
= & 
\frac{\xi_{n, \omega} \eta_{n, \omega}}{2} 
\frac{sen(2 \pi \omega)}{sen(2 \pi \omega /n)}
sen \left( 2 \pi \omega  \left( 1- \frac{1}{n} \right) \right). \\
\end{align*}
\QEDB
\vspace{0.2cm}



\begin{prop}
Sean $n \geq 2$, $\omega \geq 0$. 
Sea $\sigma_{n}(\cdot,\omega): \IR^{n} \longrightarrow [0,1]$
la función definida en \ref{def: final de sigmas}.
Para todo $x \in \IR^{n}-\{ 0 \}$
se tiene que
\begin{itemize}
	\item Si $\omega \not\in \frac{n}{2} \IZ$, entonces
	\begin{equation}
	\label{eq: pi ommm 1}
	 \Pi_{P_{\omega}}(x) = 
\frac{
\langle x, f_{n, \omega} \rangle - \langle f_{n, \omega}, g_{n, \omega} \rangle 
\langle x, g_{n, \omega} \rangle
}
{1-|\langle f_{n, \omega}, g_{n, \omega} \rangle |^{2}  }
f_{n, \omega} +
\frac{
\langle x, g_{n, \omega} \rangle - \langle f_{n, \omega}, g_{n, \omega} \rangle 
\langle x, f_{n, \omega} \rangle
}
{1-|\langle f_{n, \omega}, g_{n, \omega} \rangle |^{2}  }
g_{n, \omega}
	\end{equation}
	y 
	\begin{equation}
	\sigma_{n}(x, \omega) =
	\left(		  
		  \frac{\langle x, f_{n, \omega } \rangle^{2} +  \langle x, g_{n, \omega } \rangle^{2}	
	       -2  \langle x, f_{n, \omega } \rangle \langle x, g_{n, \omega } \rangle \langle f_{n, \omega }, g_{n, \omega } \rangle}{ || x ||^{2} \cdot
	       (1- \langle f_{n, \omega }, g_{n, \omega } \rangle^{2})}	  
\right) ^{1/2},
	\end{equation}
donde $f_{n, \omega}$ y $g_{n, \omega}$ son como en 
\eqref{eq5: 19Marzo} y \eqref{eq6: 19Marzo}, y

\item si $\omega \in \frac{n}{2} \IZ$, entonces 
\begin{equation}
\label{eq: pi ommm 2}
\Pi_{P_{n, \omega}}(x) = \langle x, f_{n, \omega} \rangle f_{n, \omega}
\end{equation}
y 
\begin{equation}
\label{eq: sfklmslsfl}
\sigma_{n}(x, \omega) = \frac{|\langle x, f_{n, \omega} \rangle |}{||x||},
\end{equation}
donde $f_{n, \omega}$ es como en \eqref{ec: 4: 23ap}.
\end{itemize}
\end{prop}


\TODO{a diferencia de la dft, los casos extremos ya no son
estar o no estar, sino ser perpendicular o ser paralelo.}

\subsection{Desfase de la proyección de una señal a espacios monofrecuenciales}

Dada $x \in \IR^{n}$ una señal no cero 
y $\omega > 0$ una frecuencia fija,
buscamos el desfase $\phi \in [0,1]$ que mejor se ajuste a $x$
(c.f. figura \ref{fig: muestreo coseno}).


Puesto que
$\Pi_{P_{n, \omega}}(x)$ (donde $P_{n, \omega}$ es como se definió en 
\eqref{eq6: 23Ap} y \eqref{eq0: 23Ap}, dependiendo si 
$\omega$ es o no elemento de $\frac{n}{2} \IZ$) 
es la señal de frecuencia $\omega$ que está a menor
distancia euclidea de $x$, proponemos usar como
desfase $\phi$ como 
el número entre cero y uno tal que 
\[
\Pi_{P_{n, \omega}}(x) = A (cos(2 \pi \omega t -  2 \pi \phi ))_{t \in I_{n}}
\]
para alguna amplitud $A$. \\

Fijada entonces una frecuencia $\omega$, nos interesa encontrar
el desfase (normalizado) $\phi$ y la amplitud $A$ del sinusoide
de frecuencia $\omega$ cuya discretización en $I_{n}$ es la proyección
ortogonal $\Pi_{P_{n, \omega}}(x)$. \\


Primero abordemos el caso en el que
$\omega \not\in \frac{n}{2} \IZ$. 

Como los vectores $f_{n, \omega}$ y $g_{n, \omega}$ 
definidos en \eqref{eq5: 19Marzo} y \eqref{eq6: 19Marzo}
son unitarios y linealmente independientes (c.f. proposición
\ref{prop: aaa}),
podemos usar la ecuación \eqref{eq0: 24ap}
para escribir a la proyección de $x$ en $P_{\omega}$ como sigue


\begin{equation}
\label{eq3: 20Marzo}
\Pi_{P_{\omega}}(x)= c (cos (2 \pi \omega t))_{t \in I_{n}} + d 
(sin (2 \pi \omega t))_{t \in I_{n}},
\end{equation}
donde

\begin{equation}
\label{eq4: 20Marzo}
c= \frac{
\langle x, f_{n, \omega} \rangle - \langle f_{n, \omega}, g_{n, \omega} \rangle
\langle x, g_{n, \omega} \rangle
}{1-\langle f_{n, \omega}, g_{n, \omega} \rangle^{2}} \xi_{n, \omega}
\end{equation}
y
\begin{equation}
\label{eq5: 20Marzo}
d= \frac{
\langle x, g_{n, \omega} \rangle - \langle f_{n, \omega}, g_{n, \omega} \rangle
\langle x, f_{n, \omega} \rangle
}{1-\langle f_{n, \omega}, g_{n, \omega} \rangle^{2}} \eta_{n, \omega}.
\end{equation}

\noindent 
Nos conviene más reescribir a \eqref{eq3: 20Marzo} como
\begin{equation}
\label{eq6: 20Marzo}
\Pi_{P_{n, \omega}}(x)= 
\sqrt{c^{2}+d^{2}}
\left[
C (cos (2 \pi \omega t))_{t \in I_{n}} +
D (sen (2 \pi \omega t))_{t \in I_{n}} 
\right],
\end{equation}

\noindent 
donde

\begin{equation}
\label{eq3: 28Marz23}
C:= \frac{c}{\sqrt{c^{2}+d^{2}}} \hspace{0.2cm} \text{y}
\hspace{0.2cm} D:= \frac{d}{\sqrt{c^{2}+d^{2}}},
\end{equation}
\noindent 
pues, como $C^{2} + D^{2}=1$, existe un único
$\phi \in [0,1[$ tal que
\begin{equation}
\label{eq7: 20Marzo}
C= cos(2 \pi \phi), \hspace{0.2cm} 
D= sin(2 \pi \phi).
\end{equation}

\noindent 
Sustituyendo \eqref{eq7: 20Marzo} en \eqref{eq6: 20Marzo},
llegamos a que

\begin{align*}
\Pi_{P_{n, \omega}}(x) = & 
\sqrt{c^{2}+d^{2}} \left[
cos(2 \pi \phi) \cdot (cos (2 \pi \omega t))_{t \in I_{n}} +
sin(2 \pi \phi) \cdot (sin (2 \pi \omega t))_{t \in I_{n}} 
\right] \\
= & 
\sqrt{c^{2}+d^{2}} 
(cos(2 \pi \phi) \cdot cos (2 \pi \omega t) +
sin(2 \pi \phi) \cdot sin (2 \pi \omega t) )_{t \in I_{n}} \\
= & 
\sqrt{c^{2}+d^{2}} 
(cos(2 \pi \omega t - 2 \pi \phi))_{t \in I_{n}}.
\end{align*}

\noindent
Además, de \eqref{eq7: 20Marzo} y \eqref{eq3: 28Marz23}
se deduce que
\begin{equation}
\label{eq: desfase phi 1}
\phi =
\begin{cases}
\frac{tan^{-1}(d/c) }{2 \pi}  \hspace{0.4cm}    \text{   si }   d, c > 0,  \\
\frac{tan^{-1}(d/c) + \pi }{2 \pi} \hspace{0.2cm}  \text{si }  d, c < 0,  \\
\frac{tan^{-1}(d/c) + \pi }{2 \pi} \hspace{0.2cm}  \text{si }  d>0,  c < 0,  \\
\frac{tan^{-1}(d/c) + 2\pi }{2 \pi} \hspace{0.2cm}  \text{si }  d>0,  c < 0. 
\end{cases}
\end{equation}

Hemos probado el siguiente
\begin{teo}
Sean $n \geq 2$ y $\omega > 0$ con $\omega \not\in \frac{n}{2}\IZ$.
Si $P_{n, \omega}$ es el subespacio de $\IR^{n}$ definido como 
en \eqref{eq6: 23Ap}, entonces, para todo 
$x \in \IR^{n}$ no cero, se tiene que
\begin{equation}
\label{ec: desfase explicito 1}
\Pi_{P_{n, \omega}} (x) = \sqrt{c^{2}+d^{2}} \cdot (
cos (2 \pi \omega t - 2 \pi \phi)
)_{t \in I_{n}} \in \IR^{n},
\end{equation}

\noindent
donde 
$c$ y $d$ son como en \eqref{eq4: 20Marzo} y 
\eqref{eq5: 20Marzo}, respectivamente, y $\phi$ está 
dado por \eqref{eq: desfase phi 1}.
\end{teo}
Observe que tenemos una fórmula para obtener a
la frecuencia y amplitud de $\Pi_{P_{n, \omega}}(x)$
usando sólamente los datos
\[
\langle x, f_{n, \omega} \rangle, \hspace{0.2cm}
\langle x, g_{n, \omega} \rangle \hspace{0.1cm} \text{y} \hspace{0.1cm}
\langle f_{n, \omega}, g_{n, \omega} \rangle.
\]

El resultado análogo para cuando $\omega \in \frac{n}{2}\IZ$
es más fácil de establecer, pues en este caso
el espacio monofrecuencia $P_{n, \omega}$ es una recta.

\begin{teo}
Sean $n \geq 2$ y $\omega > 0$ con $\omega \in \frac{n}{2}\IZ$.
Si $P_{n, \omega}$ es el subespacio de $\IR^{n}$ definido como 
en \eqref{eq0: 23Ap}, entonces, para todo 
$x \in \IR^{n}$ no cero, se tiene que
\begin{equation}
\label{ec: desfase explicito 2}
\Pi_{P_{n, \omega}} (x) = 
\frac{1}{\sqrt{n}} \langle x, f_{n, \omega} \rangle
\cdot (cos (2 \pi \omega t))_{t \in I_{n}} \in \IR^{n}.
\end{equation}
\end{teo}
\noindent
\textbf{Demostración.}
En efecto, según \eqref{eq: pi ommm 2} y 
\eqref{ec: 4: 23ap},
se tiene que
\begin{align*}
\Pi_{P_{n, \omega}} (x) = & 
\langle x, f_{n, \omega} \rangle f_{n, \omega} \\
= & \langle x, f_{n, \omega} \rangle \frac{1}{\sqrt{n}} c_{n, \omega} \\
= & \frac{1}{\sqrt{n}} \langle x, f_{n, \omega} \rangle
\cdot (cos (2 \pi \omega t))_{t \in I_{n}} \in \IR^{n}.
\end{align*}

\QEDB
\vspace{0.2cm}









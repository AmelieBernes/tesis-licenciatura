\chapter{Análisis espectrales: resultados numéricos}
\label{chap: resultados numericos analisis espectrales}

Establecida ya la teoría necesaria
para definir todos los elementos de los espectros
basados en la TDF y en espacios monofrecuenciales 
de una señal finita $x \in \IR^{n}$,
programando la funciones necesarias para realizar análisis espectrales
de los polinomios discretos de Legendre
usando estas dos metodologías; podremos así
comprobar o refutar y mejorar
la hipótesis hecha en 
\ref{ref: hipotesis}. 

Puede encontrar el código, implementado en Python,
en \TODO{cita al repositorio.} \\

Antes de mostrar las gráficas de los espectros
de algunos PDL, 
redactamos en la siguiente sección unas preguntas guía
que nos gustaría responder numéricamente, después de 
realizar análisis espectrales de los PDL
$\cali{L}^{n,k}$ de dimensión $2 \leq 2 \leq 69$. \\

No realizamos el análisis espectral para dimensiones
mayores a $69$ pues, para dimensiones más grandes, los números
involucrados en los cálculos son tan pequeños
en magnitud que son redondeados a cero
\sidenote{Puede consultar \cite{DSmath} para ver los detalles de cómo los
datos de tipo \texttt{float} son manipulados por la computadora
y los problemas de aproximación y redondeo que están implícitos en
este tipo de operaciones.}

\section{Preguntas a responder numéricamente sobre las oscilaciones de los PDL}

Enlistamos las preguntas que nos interesa considerar
relacionadas a las naturaleza oscilatoria
de los PDL $\cali{L}^{n,k}$
para dimensiones hasta $n=69$. 

La primera pregunta es una reformulación de la 
hipótesis \ref{ref: hipotesis} en términos de los 
valores $FM0(x)$ y $FM1(x)$ definidos en 
\ref{def: FM0} y \ref{def: FM1}.

\begin{pregunta}
\label{pregunta 1}
Sean $2 \leq n \leq 69$ y $0 \leq k \leq n-1$.
Sea $\cali{L}^{n,k}$ el PDL de dimensión $n$ y grado $k$.
¿las frecuencias máximas
$FP0(\cali{L}^{n,k})$ y 
$FP1(\cali{L}^{n,k})$ son cercanas a $\frac{k}{2}$?
\end{pregunta}

A continuación mostramos un dibujo para
ilustrar cómo podrían verse los
espectros del PDL
$\cali{L}^{7,5} \in \IR^{7}$
en caso de que la respuesta a la pregunta
\ref{pregunta 1} sea afirmativa.
Observe que, en el segundo espectro,
fue posible usar varios valores de $\omega$ para analizar
a $\cali{L}^{7,5}$, y que podría ser que la frecuencia máxima
sea un número decimal, mientras que para el primer espectro
(el basado en la TDF) sólo pueden usarse algunas frecuencias
enteras, por lo que no esperamos que 
$FP0(x)$
sea $\frac{5}{2}$, pues este ni siquiera es un entero.
Esperamos, sin embargo, que el máximo se de en las frecuencias
enteras cercanas al valor $\frac{5}{2}$.

\begin{figure}[H]
	\sidecaption{
	A la izquierda un dibujo (no basado en datos reales) de 
	un posible espectro para $\cali{L}^{n,k}$ basado en la 
	DFT, y a la derecha uno basado en cosenos a espacios 
	monofrecuenciales. Observe que en el segundo espectro se pueden
	considerar muchas más frecuencias que en el primero.
	\label{fig: ejemplo_pregunta1}
	}
	\centering
	\includegraphics[scale = 0.9]{./estudios_espectrales/ejemplo_pregunta1} 
\end{figure}	

\begin{pregunta}
\label{preg 2}
¿Las frecuencias 
$FP0(\cali{L}^{n,k})$ y $FP1(\cali{L}^{n,k})$
dependen, como implica la pregunta 1, sólo del parámetro
de grado $k$ y no del de dimensión $n$?
Es decir, si $k$, $n_{1}$ y $n_{2}$
son tales que $k \leq n_{1}-1$ y
$k \leq n_{2}-1$, ¿ocurre que 
$FP0(\cali{L}^{n_{1},k})$ = $FP0(\cali{L}^{n_{2},k})$
y 
$FP1(\cali{L}^{n_{1},k})$ = $FP1(\cali{L}^{n_{2},k})$?
\end{pregunta}

Para tratar de responder a la pregunta \ref{preg 2},
fijado un grado $k$,
podría ser útil graficar los puntos de la forma
\[
(n, FP0(\cali{L}^{n,k})), \hspace{0.2cm} k < n \leq 69,
\] y 
\[
(n, FP1(\cali{L}^{n,k})), \hspace{0.2cm} k < n \leq 69.
\]
Gráficas de este estilo podrían usarse para comprobar
la respuesta a la pregunta \ref{pregunta 1} 
graficando también la recta horizontal $y = \frac{k}{2}$
y viendo si los puntos graficados se encuentran cerca
de esta recta o no. 

\begin{figure}[H]
	\sidecaption{
	 De ser la respuesta
	a la pregunta \ref{preg 2} afirmativa, deberíamos
	de terminar con gráficas de puntos alineados horizontalmente, como
	en este dibujo. Sería bueno que los puntos $FP0$ y $FP1$ estuviesen
	a alturas parecidas, pues eso significaría que los dos análisis espectrales
	dan resultados parecidos.
	\label{fig: ejemplo_pregunta2}
	}
	\centering
	\includegraphics[scale = 1.4]{./estudios_espectrales/ejemplo_pregunta2} 
\end{figure}	


Para intentar refinar la aproximación hecha
en la hipótesis 
\ref{ref: hipotesis}, 
planteemos una tercera y última pregunta. 
Según esta hipótesis,
esperamos que tanto $FP0(\cali{L}^{n,k})$
como $FP1(\cali{L}^{n,k})$ sean cercanos a 
$\frac{k}{2}$; de ocurrir esto, tendríamos que los puntos de
las colecciones 
\begin{equation}
\label{eq5: May1}
(k, FP0(\cali{L}^{n,k})), \hspace{0.2cm} 0 \leq k \leq n-1
\end{equation}
y 
\begin{equation}
\label{eq6: May1}
(k, FP1(\cali{L}^{n,k})), \hspace{0.2cm} 0 \leq k \leq n-1,
\end{equation}
que se obtiene después de hacer análisis espectrales
a todos los PDL de dimensión $n$,
se ajustan a la recta $f(t) = \frac{t}{2}$. 
Una forma de comprobar o refutar esto es calcular las
rectas de mínimos cuadrados de estas dos colecciones
de puntos, y ver si las pendientes de estas son cercanas
a $1/2$ y las ordenadas al origen a $0$.
Planteamos esto en la siguiente


\begin{pregunta}
\label{preg 3}
Fijada una dimensión $2 \leq n \leq 69$,
considere las gráficas de los
puntos \eqref{eq5: May1}
y \eqref{eq6: May1}.

Sean $m_{n,0}$ y $b_{n,0}$ la pendiente y la ordenada
al origen de la recta de mínimos cuadrados calculada a 
partir del conjunto de puntos 
\eqref{eq5: May1}, y
$m_{n,1}$ y $b_{n,1}$ los correspondientes parámetros
para el conjunto de puntos 
\eqref{eq6: May1}.

Considere las nubes de puntos 
\[
(b_{n,0}, m_{n,0}), \hspace{0.2cm} 2 \leq n \leq 69
\]
y 
\[
(b_{n,1}, m_{n,1}), \hspace{0.2cm} 2 \leq n \leq 69.
\]
¿Alrededor de qué punto parecen concentrarse estas nubes?
\end{pregunta}

\begin{figure}[H]
	\sidecaption{
	Se muestran las gráficas 
	de las colecciones de puntos
	\eqref{eq5: May1} y \eqref{eq6: May1}
	para $n=7$	
	descritas en la pregunta
	\ref{preg 3}.
	\label{fig: ejemplo_pregunta3_0}
	}
	\centering
	\includegraphics[scale = 1.1]{./estudios_espectrales/ejemplo_pregunta3_0} 
\end{figure}	

\begin{figure}[H]
	\sidecaption{
	Si la estimación dada en la pregunta \ref{pregunta 1} es
	buena, las nubes de puntos descritas en la 
	pregunta \ref{preg 3} deberían estar centradas
	en el punto $(0, 0.5)$.
	\label{fig: ejemplo_pregunta3_1}
	}
	\centering
	\includegraphics[scale = 1.5]{./estudios_espectrales/ejemplo_pregunta3} 
\end{figure}	


Vamos a responder a estas tres preguntas con gráficas parecidas
a las dibujadas en las figuras
\ref{fig: ejemplo_pregunta1},
\ref{fig: ejemplo_pregunta2},
\ref{fig: ejemplo_pregunta3_0} y
\ref{fig: ejemplo_pregunta3_1}. \\


Intentaremos responder a la pregunta \ref{pregunta 1}
con gráficas análogas
a las expuestas en el ejemplo
\ref{ej: espectros comparacion},
esta vez para analizar algunos PDL; la función con la que
hacemos esto es
\texttt{analisis$\_$espectrales$\_$PDL$\_$mostrarGrafica}. 
Para calcular los datos necesarios para responder
las preguntas \ref{preg 2} y \ref{preg 3},
usando la función \texttt{analisis$\_$espectralPDL$\_$global(n)}
(\TODO{referencia al código del repositorio}), 
para toda dimensión
$2 \leq n \leq 69$ calculamos
\begin{itemize}
	\item los coeficientes $FP1(\cali{L}^{n,k})$ para toda
	$0 \leq k \leq n-1$, y guardamos esta información en el
	array \texttt{sigmasMax$\_$n},
	\item los coeficientes $FP0(\cali{L}^{n,k})$ para toda
	$0 \leq k \leq n-1$, y guardamos esta información en el
	array \texttt{tausMax$\_$n},
	\item y los números $b_{n,0}$, $m_{n,0}$,
	$b_{n,1}$ y $m_{n,1}$ como se definieron en la pregunta
	\ref{preg 3}.
\end{itemize}
Toda esta información se calculó una sola vez y se almacenó
en un diccionario, cuyas llaves son las dimensiones
$n$, y cuyo valor asociado a la llave $n$ es la $6-$tupla
\[
(sigmasMax\_n, tausMax\_n, b_{n,0}, m_{n,0}, b_{n,1}, m_{n,1}).
\]

Usamos el 
módulo \texttt{pickle} para guardar los datos como secuencias
de bytes. El archivo binario en el que se almacenaron los
datos calculados con la función 
\texttt{analisis$\_$espectralPDL$\_$global(n)}
es \texttt{data$\_$AE.txt}. \\

La función con la que obtenemos gráficas análogas 
a la de la figura 
\ref{fig: ejemplo_pregunta2} es
\texttt{grafica$\_$analisisGlobal$\_$k$\_$fijo}
y, para obtener gráficas análogas a la de la figura
\ref{fig: ejemplo_pregunta3_0},
usamos \texttt{graficar$\_$analisis$\_$espectralPDL$\_$global}.
\TODO{Dí que mallas de omegas usaste para el espectro 1!}

\section{Gráficas y conclusiones}

Veamos qué pasa con $n=7$.

\begin{figure}[H]
	\sidecaption{
	\label{fig: 7_0,1}
	}
	\centering
	\includegraphics[angle = 90, scale = 0.85]{./estudios_espectrales/7_0,1} 
\end{figure}	

\begin{figure}[H]
	\centering
	\includegraphics[angle = 90, scale = 0.85]{./estudios_espectrales/7_2,3} 
\end{figure}	

\begin{figure}[H]
	\centering
	\includegraphics[angle = 90, scale = 0.85]{./estudios_espectrales/7_4,5} 
\end{figure}	


\begin{figure}[H]
	\sidecaption{
	Observe que $FP0(\cali{L}^{7,0}) = 0 = FP1(\cali{L}^{7,0})$
	pero $FP0(\cali{L}^{7,1}) = 1 $ mientras que 
	$FP1(\cali{L}^{7,1})$, aunque no es cero, es un decimal muy cercano
	a cero; observe en la figura \ref{fig: 7_0,1}, donde se dibujan
	los espectros de los dos primeros PDL de dimensión $7$ que, en efecto,
	usando un sinusoide de frecuencia 
	$0.01$ (la dada por el espectro
	basado en espacios monofrecuenciales), 
	logramos ajustar casi a la perfección la gráfica de $\cali{L}^{7,1}$
	(que, según el teorema \ref{cor: BON de legendre para espacios Wk}, yace
	en una recta, por lo que no puede ser ajustada a la perfección por un
	sinusoide),
	mientras que usando un sinusoide de frecuencia $1$ (la dada por el 
	espectro basado en la TDF), no se logran ajustar tan bien los datos.
	\label{fig: 7}
	}
	\centering
	\includegraphics[scale = 0.5]{./estudios_espectrales/7} 
\end{figure}	

Como notamos en la descripción de la figura
\ref{fig: 7}, parece que usando el estudio espectral basado en 
espacios monofrecuenciales obtenemos una aproximación de la gráfica
de $\cali{L}^{n,1}$, con $n=7$, en base a un sinusoide de frecuencia muy baja;
grafiquemos 
\TODO{aaa} para ver si esta es una particularidad de la dimensión
$n=7$ o si también ocurre para otros valores de $n$.

\begin{figure}[H]
	\sidecaption{
	Comprobamos numéricamente que los resultados del espectro-1
	sugieren usar frecuencias muy bajas para modelar los 
	PDL de grado $1$; la única excepción se da para $n=3$. Graficamos
	a continuación los espectros de $\cali{L}^{3,1}$ para ver qué
	está sucediendo.
	\label{fig: k_1}
	}
	\centering
	\includegraphics[scale = 0.5]{./estudios_espectrales/k_1} 
\end{figure}	


\begin{figure}[H]
	\sidecaption{
	Como se muestra en los espectros, el coeficiente
	$\sigma_{3}(\mathcal{L}^{3,1}, \omega)$ es, para casi toda
	$\omega$ considerada, muy cercana a uno, por lo que cualquiera
	de estas frecuencias sería adecuada para aproximar con un sinusoide la 
	gráfica de $\mathcal{L}^{3,1}$. Por la forma en que programamos
	el proceso, se usa la última frecuencia más alta, que resultó ser
	$1.48$. Como puede comprobar en las gráficas de abajo, se puede
	aproximar bien la gráfica de $\mathcal{L}^{3,1}$ tanto
	con frecuencia $\omega = 1$ como con frecuencia
	$\omega = 1.48$.
	\label{fig: 3_1}
	}
	\centering
	\includegraphics[scale = 0.45]{./estudios_espectrales/3_1} 
\end{figure}	

Comprobemos, graficando los espectros 
de algunos PDL de grado $1$ y dimensión mayor a $3$, 
que frecuencias muy cercanas a $0$ son buenas para modelar
la gráfica de $\cali{L}^{n,1}$, hecho que es 
sugerido por la figura \ref{fig: k_1}.

\begin{figure}[H]
	\sidecaption{
	Note que en este espectro no ocurre lo que se tenía
	en el del PDL $\cali{L}^{3,1}$ (c.f. figura 
	\ref{fig: 3_1}); en este caso, el espectro-$1$ muestra
	claramente que $\omega =0.1$, la frecuencia en $Dom_{\omega, n}$
	más cercana a $0$ que \textbf{no} es cero, es la mejor.
	\label{fig: 8_1}
	}
	\centering
	\includegraphics[scale = 0.45]{./estudios_espectrales/8_1} 
\end{figure}	
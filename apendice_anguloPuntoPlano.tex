\section{Ángulo entre elementos de un espacio con producto punto}
\label{angulo entre elementos de un espacio con producto punto}

Es gracias a la desigualdad de Cauchy-Schwarz
que es posible introducir una de las nociones
más valiosas con las que se cuenta en un espacio
vectorial con producto punto, a saber, la de \textbf{ángulo} entre dos
vectores.

Si $v$ y $w$ son dos elementos no cero de $V$, entonces,
según el teorema \ref{Teo:CauchySchwarz},
\[
-1 \leq \frac{\langle v, w \rangle}{||v|| \cdot ||w||} \leq 1,
\]
luego, puesto que la función coseno es una biyección
del intervalo $[0, \pi]$ al intervalo $[-1,1]$,
tenemos que existe un único elemento 
$\theta \in [0, \pi]$ tal que

\[
cos(\theta)= \frac{\langle v, w \rangle}{||v|| \cdot ||w||};
\]
a tal número $\theta$ se le denomina el 
\textbf{ángulo formado por los vectores $v$ y $w$},
y lo denotamos por $\measuredangle (v, w)$

Si alguno de los vectores $v$ o $w$ fuese cero, definimos
el ángulo entre estos como cero.

\begin{figure}[H]
	\sidecaption{
	Si $\theta$ es el ángulo entre $v$ y $w$,
	los casos extremos en los que $\theta \in \{ 0, \pi \}$
	son aquellos en los que $v$ y $w$ son múltiplos escalares
	uno del otro, mientras que, si $cos(\theta)=0$, o sea, 
	si $\theta = \frac{\pi}{2}$, entonces $v$ y $w$ son perpendiculares.
 	\label{fig:coseno}
	}
	\centering
	\includegraphics[scale=0.5]{coseno} 
\end{figure}	


Terminamos esta sección con una sencilla observación, que es 
consecuencia de la linealidad del producto punto y de la norma.

\begin{obs}
\label{obs: angulo se preserva por mult. esc.}
\textbf{(El ángulo entre dos vectores no se ve afectado
por multiplicación por un mismo escalar)}
Sean $V$ un espacio de Hilbert, $u, v \in V$ no cero.
Si $a \in F$ es un escalar no cero, entonces
$\measuredangle (v, w) = \measuredangle (a \cdot v, a \cdot w)$
\end{obs}

\section{Definición de ángulo entre un punto y un subespacio cerrado de un espacio euclideo}
\label{sec: def del angulo entre un punto y un subespacio cerrado}

Ya vimos en \ref{angulo entre elementos de un espacio con producto punto}
cómo definir el ángulo entre dos elementos de un espacio
de Hilbert $V$.

Si además $W$ es un subespacio cerrado de $V$
(lo que, recuerde, siempre ocurre en caso de que
$V$ sea finito dimensional, c.f. teorema 2.4-3 de \cite{Kreyszig}), entonces también
es posible definir el ángulo entre un punto $x \in V$
del espacio y $W$.

\begin{defi} \label{def: angulo punto subespacio}
Sea $(V, \langle \cdot , \cdot \rangle)$ un espacio con 
producto punto. Sean $W \leq V$ un subespacio cerrado de $V$
y $x \in V$. Definimos el \textbf{ángulo entre $x$ y $W$}
como el ángulo que forma 
$x$ con su proyección a $W$, es decir,
\[
\measuredangle (x, W):= \measuredangle(x, \Pi_{W}(x)).
\]
\end{defi}

Una definición alternativa del ángulo entre un punto y un subespacio,
así como una caracterización sencilla del coseno de este,
se dan a continuación.

\begin{prop}
\label{prop: algunos hechos sobre el angulo entre un vector y un subespacio}
Si $V$, $W$ y $x$ son como en la definición 
\ref{def: angulo punto subespacio}, entonces

\begin{itemize}
\item 
$\measuredangle (x, W) = min \{ \measuredangle(x,w) \hspace{0.1cm} :
 \hspace{0.1cm} w \in W \}$, y

\item $cos \left( \measuredangle (x, W) \right) = \frac{|| \Pi_{W}(x) ||}{||x||}$.
\end{itemize}


\end{prop}
\noindent
\textbf{Demostración.}
\begin{itemize}
\item  Sea $w$ un elemento cualquiera de $W$.
Puesto que el ángulo entre dos vectores es
preservado bajo multiplicación por escalares
(c.f. observación
\ref{obs: angulo se preserva por mult. esc.}), sin pérdida de generalidad
podemos suponer que 
\begin{equation}
\label{eq1: 9Feb}
||w||= || \Pi_{W}(x)||.
\end{equation}

De la definición del vector $\Pi_{W}(x)$ se sigue que
\[
|| x -\Pi_{W}(x) ||^{2} \leq  || x - w||^{2};
\]
expresando ambos lados de la desigualdad como un producto
punto (c.f. \eqref{eq: norma via producto punto}) y aplicando la
bilinealidad del producto punto, llegamos a que
\[
\langle x , x \rangle -2 \langle x, \Pi_{W}(x) \rangle +
\langle \Pi_{W}(x) , \Pi_{W}(x) \rangle \leq 
\langle x , x \rangle  -2 \langle x , w \rangle 
+ \langle w , w \rangle ;
\]
usando \eqref{eq1: 9Feb}, podemos simplificar esta
última desigualdad para llegar a 
\[
\langle x, w \rangle \leq \langle x, \Pi_{W}(x) \rangle,
\]
de donde se sigue, usando nuevamente \eqref{eq1: 9Feb},
que 
\[
cos \left( \measuredangle (x,w) \right) =
\frac{\langle x , w \rangle}{||x||\cdot ||w||} \leq
\frac{\langle x ,  \Pi_{W}(x)  \rangle}{||x||\cdot ||\Pi_{W}(x) ||} =
cos \left( \measuredangle \left(x, \Pi_{W}(x) \right) \right);
\]
del que la función coseno sea decreciente en el intervalo
$[0, \pi]$ se concluye de esta última desigualdad que
$ \measuredangle \left(x, \Pi_{W}(x) \right) \leq 
\measuredangle (x,w)$.

\item Según el corolario 
\ref{cor: x como suma de proyecciones}, 
$x$ puede expresarse como la suma entre su proyección
a $W$ y su proyección a $W^{\perp}$, luego,
según la definición \ref{def: angulo punto subespacio}
y la linealidad del producto punto, concluimos que

\begin{align*}
cos \left( \measuredangle (x, W) \right) = &
cos \left( \measuredangle (x, \Pi_{W}(x)) \right)  \\
= & 
\frac{\langle x , \Pi_{W}(x) \rangle}{||x|| \cdot || \Pi_{W}(x)||}  \\
= & 
\frac{\langle \Pi_{W}(x)+\Pi_{W\perp}(x) , \Pi_{W}(x) \rangle}{||x|| \cdot || \Pi_{W}(x)||}\\
= & \frac{\langle \Pi_{W}(x) , \Pi_{W}(x) \rangle}{||x|| \cdot || \Pi_{W}(x)||}\\
= & \frac{|| \Pi_{W}(x) ||^{2}}{||x|| \cdot || \Pi_{W}(x)||}\\
= & \frac{|| \Pi_{W}(x) ||}{||x||}.
\end{align*}
\end{itemize}

\QEDB
\vspace{0.2cm}

\begin{nota}
Observe que, según el segundo punto de la proposición 
\ref{prop: algunos hechos sobre el angulo entre un vector y un subespacio}, 
el coseno entre un vector $x$ y un subespacio cerrado $W$ es
siempre no negativo; esto nos permite acotar el rango en el que
se encuentra el ángulo (que, por definición, es $[0, \pi]$)
y afirmar que $\measuredangle(x, W) \in [0, \frac{\pi}{2}]$.
\end{nota}

\subsection{Caso particular en el que el subespacio en cuestión es un plano}
\label{ap: Caso particular en el que el subespacio en cuestión es un plano}

Necesitaremos concetrarnos en el caso
particular en el que el subespacio cerrado $W$ es 
un plano,\sidenote{O sea, un subespacio
de dimensión $2$.} por lo que elaboremos un poco más
la teoría de la sección 
\ref{angulo entre elementos de un espacio con producto punto}
para este caso particular.

La situación es la siguiente: $V$ es un $\IR-$espacio
de Hilbert, $u$ y $v$ son elementos de $V$,
unitarios y linealmente
independientes entre sí. El espacio que ellos generan
es pues un plano, digamos,


\[
P := span \{ u, v \}.
\]

Dado $x \in V$ unitario, 
el coseno del ángulo entre $x$ y $W$ es,
según la proposición
\ref{prop: algunos hechos sobre el angulo entre un vector y un subespacio},

\begin{equation}
\label{eq0: 19Marzo}
cos \left( \measuredangle (x, P) \right) = || \Pi_{P}(x) ||;
\end{equation}
para lograr expresar el lado derecho de la igualdad en términos
sólo de $u$, $v$ y $x$ (que son los elementos básicos de
nuestra discusión), conviene primero considerar una base
ortonormal del espacio $P$.


\begin{obs}
Si $u, v \in V$ son unitarios y linealmente independientes, y $P$
es el plano que generan, entonces
$\{ u, z \}$, donde

\begin{equation}
\label{eq2: 19Marzo}
z:= \frac{v- \langle u, v \rangle u}{||v- \langle u, v \rangle u||}
\end{equation}
es una BON de $P$
\end{obs}
\noindent
\textbf{Demostración.}
Basta aplicar el teorema de Gram-Schmidt 
\ref{Teo:Gram-Schmidt}.
\QEDB
\vspace{0.2cm}

Teniendo una BON de $P$, según el 
corolario 
\ref{cor: proyeccion en terminos de BON}, se tiene la siguiente
expresión para la proyección de $x$ en $P$;

\begin{equation}
\label{eq1: 19Marzo}
\Pi_{P}(x)= \langle x, u \rangle u + \langle x, z \rangle z;
\end{equation}

\noindent
puesto que, según la definición \eqref{eq2: 19Marzo} de 
$z$ este vector es función de $u$ y $v$, fácilmente se
puede derivar, a partir de \eqref{eq1: 19Marzo},
una expresión de $\Pi_{P}(x)$ en función sólo
de $x$, $u$ y $v$. Se plasman las fórmulas 
concretas (sin demostración, pues esta involucra
simple aritmética) en la siguiente proposición.

	\begin{prop}
	\label{prop: formulas 20Marzo}
	Sean $V$ un espacio de Hilbert, $x \in V$ unitario,
	$u,v \in V$ linealmente independientes. Si $P$ es el plano
	que generan, entonces,

		\begin{equation}
		\label{eq3: 19Marzo}
		\Pi_{P}(x)= \frac{\langle x, u \rangle -\langle u, v \rangle \langle x, v \rangle }{1-\langle u, v \rangle^{2}} u + \frac{\langle x, v \rangle -\langle u, v \rangle \langle x, u \rangle }{1-\langle u, v \rangle^{2}} v
		\end{equation}
	y 
		\begin{equation}
		\label{eq3: 19Marzo}
		  || \Pi_{P}(x) ||^{2}=
		  \frac{1}{1- \langle u, v \rangle^{2}} \left(  
	       \langle x, u \rangle^{2} +  \langle x, v \rangle^{2}	
	       -2  \langle x, u \rangle^{2} \langle x, v \rangle^{2} \langle u, v \rangle^{2}	  
		  \right).
		\end{equation}
 
	\end{prop}



\section{Similitud coseno}
\label{cosine similarity}

Sea $V$ un espacio de Hilbert.
Sean $W \subseteq V$ un subespacio cerrado de $V$ y 
$x$ un elemento cualquiera de $V$. Hay dos formas ``naturales''
de intentar medir la cercanía de $x$ a $W$:
\begin{itemize}
\item[a)] \textbf{Usando la distancia euclidea
de $x$ a $W$}, es decir, tomando la norma del vector
$x - \Pi_{W}(x)$ como una medida
de qué tanto pertenece $x$ a $W$.
\item[b)] \textbf{Usando el ángulo que $x$ forma con $W$}: como ya
vimos en la sección 
\ref{sec: def del angulo entre un punto y un subespacio cerrado}, el ángulo 
$\measuredangle (x, W) \in [0, \frac{\pi}{2}]$
entre $x$ y $W$
está definido como el ángulo entre $x$ y su proyección
$\Pi_{W}(x)$ a $W$, luego, 
	\begin{itemize}
		\item entre más cercano a cero sea $\measuredangle (x, W)$,
		$x$ se aleja más del plano $W$, pues es casi perpendicular 
		al elemento de $W$ más cercano a $x$, y
		
		\item entre más cercano a uno sea $\measuredangle (x, W)$,
		más se acerca $x$ a ser paralelo a su representante en $W$,
		luego, más se acerca $x$ a pertenecer a $W$.
	\end{itemize}
\end{itemize}

\begin{figure}[H]
	\sidecaption{
	Esquema de dos formas en las que uno puede intentar medir
	qué tan afín es una señal $x$.
	\label{fig: dos formas de medir distancia a plano}
	}
	\centering
	\includegraphics[scale= 1]{ 18Sept_1} 
\end{figure}	

Este segundo
enfoque es conocido como ``\textbf{cosine similarity}'' en
inglés (c.f. \cite{cosineSim}). Una ventaja, que será clave
para nosotros, del segundo método sobre el primero se
expone en el siguiente resultado.


\begin{prop}
\label{prop: angulo se conserva bajo mult. esc.}
Sean $V$ un espacio euclideo, $W \subseteq V$ cerrado, $x \in V$,
$a \in \IR - \{ 0 \}$. Si $|a| \neq 1$, la distancia euclídea 
de $a \cdot x$ a $W$ es distinta
a la de $x$ a $W$, mientras que los 
ángulos que forman $a \cdot x$ y $x$
con $W$ coinciden.
\end{prop}
\noindent
\textbf{Demostración.}
En efecto, 

\[
|| a \cdot x - \Pi_{W}(a \cdot x) || = |a| \cdot || x - \Pi_{W}(x) ||, 
\]
y

\begin{align*}
\measuredangle (a \cdot x, W_{n,1}):=& \measuredangle(a \cdot x, \Pi_{W_{n,1}}(a \cdot x)) \\
= & \frac{\langle a \cdot x , \Pi_{W_{n,1}}(a \cdot x) \rangle}{|| a \cdot x || \cdot 
|| \Pi_{W_{n,1}}(a \cdot x)  ||} \\
= & \frac{a^{2}  \langle   x , \Pi_{W_{n,1}}(x) \rangle}{a^{2} ||  x || \cdot 
|| \Pi_{W_{n,1}}( x)  ||}  \\
= & \measuredangle (x, W_{n,1}).
\end{align*}


\QEDB
\vspace{0.2cm}

Así el criterio $b)$ no se ve afectado por multiplicación escalar,
mientras que el $a)$ sí.
 



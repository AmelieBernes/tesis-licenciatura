\section{Relación entre los espectros basados en la TDF y en espacios monofrecuenciales}

Después de todo lo expuesto en las secciones anteriores, tenemos
ya dos alternativas para realizar un análisis
espectral de una señal $x \in \IR^{n}$.

Sean $n \geq 2$, $M := \lceil \frac{n}{2} \rceil$, $x \in \IR^{n}$.
\begin{itemize}
	\item \textbf{(Espectro-0: basado en la TDF)} 
	Usando la transformada discreta de Fourier
	(c.f. sección \ref{sec: TDF}),
	el espectro de $x$ es la función
	\[
	\Tau_{x}: Dom_{TDF, n} \longrightarrow \IR^{+}_{0}
	\]	
	definida en \ref{def: espectro DFT}.
	
	La gráfica es entonces la de las frecuencias
	enteras $\omega$ dadas (dependiendo de la 
	paridad de $n$) por las
	tablas 6.1 y 6.2
	versus los coeficientes
	$\tau_{n}(x, \omega)$ definidos en
	\ref{def: taus}.
	
	Puesto que el realizar un análisis de 
	$x$ via la TDF significa encontrar una
	expresión de $x$ como una suma
	ponderada de muestreos de senos y cosenos,
	de frecuencias enteras las indicadas en las tablas 6.1 o 6.2,
	se tiene que  
	\begin{itemize}
		\item Para toda frecuencia $\omega$ considerada
		por la TDF,
		\[
		0 \leq \tau_{n}(x, \omega) \leq 1,
		\]
		y que
		\item entre más se acerque
		$\tau_{n, \omega}(x)$
		a $1$, mayor es la
		importancia de la frecuencia $\omega$ para
		sintetizar s $x$; recíprocamente, si 
		$\tau_{n}(x, \omega)$ es cercana a cero, entonces
		la frecuencia $\omega$ no es muy relevante para 
		sintetizar a la señal $x$.
	\end{itemize}
	\begin{defi}
	\label{def: FM0}
	Llamaremos \textbf{frecuencia principal-0}
	(y denotaremos por $FP0(x)$) 
	a una 
	frecuencia $\omega \in Dom_{TDF, n}$
	tal que, para cualquier otra $\omega' \in Dom_{TDF, n}$ 
	se tenga que 
	\[
	\tau_{n}(x, \omega') = \Tau_{x}(\omega^{'}) \leq
	\Tau_{x}(\omega) =  
	 \tau_{n}(x, \omega).
	\]
	\end{defi}
	Observe que tal frecuencia principal existe por ser 
	el máximo de un conjunto finito de números, pero que no 
	estamos asegurando que sea única. Tomamos pues
	como FP0 de $x$ a la mayor de las $\omega \in Dom_{TDF, n}$ 
	que satisfaga la definición \ref{def: FM0}.
	\item \textbf{(Espectro-1: basado en espacios monofrecuenciales)} 
	Recuerde que este espectro 
	$
	\Sigma_{x} : \left[0, \frac{n}{2} \right] \longrightarrow [0,1].
	$
	se definió en \ref{def: espectro monofrecuenciales inicial}.
	
	La gráfica de este espectro es la de 
	las frecuencias $\omega \in ]0, \frac{n}{2}[$ versus	
	los coeficientes
	$\sigma_{n}(x, \omega) = cos(\measuredangle(x, P_{n, \omega}))$ definidos en 
	\ref{prp: ammm}, y 
	los puntos extremos del espectro son
	\[
	(0, cos(\measuredangle(x, W_{n,1})))
	\hspace{0.2cm} \textit{ y } \hspace{0.2cm}
	(n/2, cos(\measuredangle(x, \tilde{W}_{n,1}))).
	\]	
	Observe que
	\begin{itemize}
		\item para cualquier frecuencia $\omega \in [0, n/2]$, se tiene que
		\[
		0 \leq \sigma_{n}(x, \omega) \leq 1
		\]
		\item 
	y, para $w \in ]0, n/2[$, el que
	$\Sigma_{x}(\omega) = \sigma_{n}(x, \omega)$ sea cercano a $1$ significa que un
	muestreo uniforme de un sinusoide de frecuencia $\omega$
	modela bien el comportamiento de $x$,
	mientras que un $\sigma_{n}(x, \omega)$ cercano
	a cero significa que 
	$x$ es casi perpendicular a toda señal de frecuencia $\omega$
	(c.f. nota \ref{nota: significado de los sigma en AE}).
	Similarmente, si $\omega = 0$ o $\omega = n/2$, el que
	$\Sigma_{x}(\omega)$ sea cercano a $1$ significa que $x$
	es cercano al espacio $W_{n,1}$ o $\tilde{W}_{n,1}$, respectivamente.
	
	\begin{defi}
	\label{def: FM1}
	Llamaremos \textbf{frecuencia principal-1} (y denotaremos por
	FP1(x)) a una frecuencia $\omega' \in [0, n/2]$ tal que,
	para cualquier otra $\omega \in [0, n/2]$ se tenga que
	\[
	\Sigma_{x}(\omega) \leq \Sigma_{x}(\omega').
	\]
	\end{defi}
	Observe que, por ser el espectro $\Sigma_{x}$ una función continua
	en su dominio (c.f. 
	proposición \ref{prop: continuidad espctro espacois monof.}), 
	que es un intervalo cerrado de $\IR$, $\Sigma_{x}$
	alcanza su máximo (c.f. teorema del valor extremo, 
	\cite{spivak} p. 130), luego, \ref{def: FM1} es una buena 
	definición. Sorteamos el problema de la posible no unicidad
	de una frecuencia que satisfaga la definición de frecuencia
	principal-1 acordando que se tomará como FP1
	a la mayor de las frecuencias $\omega \in [0, n/2]$ que satisfaga 
	la definición \ref{def: FM1}.
	De todas formas, 
	en la práctica se tendrá que fijar un conjunto
	finito $\cali{P} \subseteq [0, n/2]$ de frecuencias
	para calcular, de forma computacional, el espectro
	$\Sigma_{x}$. Para respetar la convención
	puesta en la nota 
	\ref{nota: muestreo dom frecuencia}, vamos
	a tomar a $\cali{P}$ como en 
	\eqref{eq: malla frecuencias}.
	\end{itemize}
\end{itemize}
	

Para establecer una relación entre los espectros
$\Tau_{x}$ y $\Sigma_{x}$ de una señal así definidos,
será de utilidad la siguiente proposición.
\begin{prop}
\label{prop: coinciden espectr}
Sean $n \geq 2$, $x \in \IR^{n}$.
Sea $Dom_{TDF, n}$ el dominio del espectro-0 de $x$
como se definió en \ref{def. Dom tdf}. Se tiene que
\begin{equation}
\label{eq4: 4May}
\forall \omega \in Dom_{TDF, n}:
\hspace{0.2cm} \tau_{n}(x, \omega) = \sigma_{n}(x, \omega).
\end{equation}
\end{prop}

\noindent
\textbf{Demostración.}
Recuerde que los coeficientes
$\sigma_{n}(x, \omega)$
se definieron como
\[
\sigma_{n}(x, \omega) = \frac{|| \Pi_{P_{n, \omega}}(x) ||}{|| x ||}.
\]
Teniendo una base ortonormal del espacio 
$P_{n, \omega}$ puede calcularse la proyección involucrada en la fórmula
para $\sigma_{n}(x, \omega)$.
Recuerde que, por definición del espacio $P_{n, \omega}$,
\begin{itemize}
	\item los vectores $c_{n, \omega}$ y $s_{n, \omega}$ conforman
	una base de $P_{n, \omega}$ cuando $1 \leq \omega \leq M-1$ 
	(pues, para estos valores de omega se tiene siempre
	que $\omega \not\in \frac{n}{2} \IZ$) y
	\item $c_{n, \omega}$ conforma una base 
	de $P_{n, \omega}$ cuando $\omega = 0$ y,
	en el caso en el que $n$ es par, también para cuando $\omega = M$
	(pues sólo para estos valores de omega se tiene 
	que $\omega \in \frac{n}{2} \IZ$).
\end{itemize}
Además, según la proposición
\ref{prop: base de fourier version real},
para todas estas $\omega$,
los vectores de la lista anterior son ortogonales entre
sí y tienen norma uno, luego, más que una base de 
$P_{n, \omega}$ constituyen una BON para este espacio.
Así, $\Pi_{P_{n, \omega}}(x)$ puede encontrarse 
simplemente calculando los productos punto 
de $x$ con los elementos de estas BONs (c.f. 
nota \ref{nota: sobre la identidad de parseval});
comparando este cálculo con la definición 
\ref{def: taus}
de los coeficientes $\tau_{n}(x, \omega)$,
concluimos que en efecto se
tiene la iguadad \eqref{eq4: 4May}.

\QEDB
\vspace{0.2cm}

Usando la definición del espectro
$\Sigma_{x}$ en el interior de su dominio
$]0,1[$ (c.f. definición
\ref{def: espectro monofrecuenciales inicial})
y la proposición anterior, se sigue
de inmediato el siguiente resultado.
\begin{cor}
\label{cor: relacion espectros}
\textbf{(Relación entre los espectros $\Tau_{x}$ y 
$\Sigma_{x}$ de una señal)}
Sea $n \geq 2$, $x \in \IR^{n}$.
Para toda $\omega \in Dom_{TDF, n} - \{0, n/2 \}$
se tiene que
\[
\Tau_{x}(\omega) = \Sigma_{x}(\omega).
\]
\end{cor}

Así, \textbf{el espectro basado en espacios monofrecuenciales
es una extensión de la definición del espectro 
basado en la transformada discreta de Fourier}.
Como ya recordamos al inicio, la
ventaja de este primer espectro $\Sigma_{x}$
es que para calcularlo es posible usar
un rango cualquiera de frecuencias no negativas, mientras que el segundo, 
a pesar de que da no sólo un proceso de análisis de una señal 
de $x$ a partir de sinusoides, sino también uno de síntesis
(c.f. nota \ref{nota: ya?}), se limita a considerar las frecuencias 
en $Dom_{TDF, n}$. \\

Observe que,
para toda $n$, el conjunto de frecuencias enteras 
consideradas por la TDF, $Dom_{TDF, n}$, está
contenido en $[0, n/2]$, luego, 
según el corolario 
\ref{cor: relacion espectros},
basta calcular 
a $\Sigma_{x}$ en $[0, n/2]$
para tener ambos análisis espectrales.


\begin{nota}
\label{nota: la mejor frecuencia}
Fijados $n \geq 2$
y $x \in \IR^{n}$, \textbf{entre más cercano a $1$ sea 
el coeficiente 
$\sigma_{n}(x, \omega)$, mejor es usar un sinusoide
de frecuencia $\omega$ para ajustar la gráfica de $x$}.
Esto porque, recuerde, entre más cercano a uno sea uno de
esos coeficientes, más cercana estará la señal $x$ 
al espacio monofrecuencial $P_{n, \omega}$, luego, más
cercana está $x$
a tener
la propiedad de ser una discretización de un sinusoide
de la respectiva frecuencia $\omega$.
\end{nota}

\begin{nota}
\label{nota: proyeciones monof TDF}
Sea $x \in \IR^{n}$; sea 
\eqref{ec: sintesis 0} o 
\eqref{ec: sintesis 1}
(dependiendo de la paridad de $n$)
la síntesis de $x$ respecto a la base de Fourier
real $\cali{F}_{n}$. De esta suma podemos
separar los sumandos que corresponden a una
cierta frecuencia $\omega \in Dom_{TDF, n}$; recordando
que, como se notó
en la demostración de la proposición
\ref{prop: coinciden espectr}, 
los correspondientes vectores
de frecuencia $\omega$ (que son ya sea uno o dos, dependiendo del valor
de $\omega$) conforman una BON para el correspondiente
espacio monofrecuencial 
$P_{n, \omega}$, tenemos que la parte de la 
síntesis de $x$ que corresponde a 
cierta frecuencia $\omega$ es igual a
$\Pi_{P_{n, \omega}}(x)$. \\

Aplicando esto al ejemplo \ref{ej: DFT1},
si $x$ es la señal definida en 
\ref{eq2: 10ab}, se tiene que
\[
\Pi_{7, 0} = 4.12 c_{7,0}, 
\]
\[
\Pi_{7, 1} = -8.76 c_{7,1} - 7.35 s_{7,1}, 
\]
\[
\Pi_{7, 2} = 4.77 c_{7,2} - 10 s_{7,2}, 
\]
\[
\Pi_{7, 3} = 0.14 c_{7,3} + 9.91 s_{7,z3}.
\]
\end{nota}



\begin{ejemplo}
\label{ej: espectros comparacion}

Sea $f_{\omega}$
el sinusoide definido como
\begin{equation}
\label{eq: sinusoide eje}
f_{\omega}(t) := -1.5 cos (2 \pi \cdot \omega t + 2 \pi \cdot 0.2).
\end{equation}
Considere a una señal $x \in \IR^{36}$ que sea el resultado
de muestrear uniformemente al sinusoide
$f_{3.4}$
con ruido aleatorio 
(con distribución, pongamos, uniforme en $[-0.5, 0.5]$).

A continuación, mostramos las gráficas
de los espectros de $x$. Para
calcular el espectro $\Sigma_{x}$,
usamos el dominio
establecido en la nota 
\ref{nota: muestreo dom frecuencia}.

\begin{figure}[H]
\centering
	\sidecaption{De ahora en adelante, siempre que
	grafiquemos espectros, usaremos los colores y notaciones
	de esta figura. \label{fig: ejemplo_comparacion}}
    \includegraphics[scale = 1.4]{./estudios_espectrales/ejemplo_comparacion_1}
\end{figure}


Observe cómo el espectro-$1$ parece completar la información
dada por el espectro-$0$, pues, a diferencia del primero,
el espectro-$0$
da coeficientes de frecuencia $\tau_{n}(x, \omega)$ sólo
para algunas frecuencias enteras $\omega$, mientras que en el espectro-$1$
es posible considerar cualesquiera frecuencias $\omega \geq 0$; como puede observar
en la gráfica, 
\[
FP0 (x) = 3 \hspace{0.2cm} \textit{y} \hspace{0.2cm}
FP1 (x) = 3.42;
\]
esta segunda frecuencia es mucho más cercana a
la frecuencia $\omega =3.4$ del sinusoide del que
fue obtenida la señal $x$; como agregamos ruido
aleatorio en las mediciones, no 
es de extrañarse que no se haya
obtenido exactamente $FP1(x) = 3.4$.

A pesar de que el espectro-$0$, el obtenido a partir de la
transformada discreta de Fourier, no dio una mala estimación (del rango
de frecuencias $Dom_{TDF,n}$ considerado por esta herramienta,
$\omega =3$ es el valor más cercano al valor real $\omega = 3.4$), vemos en este
ejemplo que usando el espectro-$1$ es posible obtener mejores
estimaciones de frecuencias que modelen a la señal original. \\

Mostramos ahora la gráfica de $x$ junto con
\begin{itemize}
	\item la parte de la síntesis de $x$ respecto a la $TDF$
	que corresponde a la frecuencia principal
	$FP0(x)$ (c.f.
	nota \ref{nota: ya?}), que de hecho,
	según la nota \ref{nota: proyeciones monof TDF}, es
	$\Pi_{P_{36,3}}(x)$
	\begin{figure}[H]
			\sidecaption{
			Puesto que $\{ c_{36, 3}, s_{36, \omega} \}$
			es una BON de $P_{36, 3}$, claro que la señal 
			que resulta de discretizar el sinusoide morado en la malla
			$I_{36}$ es, de hecho, la proyección de $x$ 
			al espacio monofrecuencial $P_{36, 3}$.
 			\label{fig: comparacion 2}
			}
			\centering
			\includegraphics[scale = 0.5]{31May_esp5} 
		\end{figure}		
	
	y
	\item la señal $\Pi_{P_{16, 3.42}}(x)$, o sea, la señal de
	dimensión $36$ y frecuencia $FP1(x)=3.42$ más cercana a $x$, junto con
	el sinusoide continuo del que fue muestreado.
	\begin{figure}[H]
			\sidecaption{
			Para obtener la versión continua del sinusoide 
			discreto $\Pi_{P_{36, 3.42}}(x)$ (i.e. la gráfica naranja),
			usamos las fórmulas establecidas en los teoremas
			\ref{teo: amelie1} y \ref{teo: amelie2}.
			\label{fig: comparacion 3}
			}
			\centering
			\includegraphics[scale = 0.5]{31May_esp6} 
		\end{figure}		
\end{itemize}


Los sinusoides de las figuras \ref{fig: comparacion 2} y
\ref{fig: comparacion 3}
son las señales de frecuencia pura
$3$ y $3.42$, respectivamente, cuya distancia euclidea
a la señal original $x$ es mínima. Observe que la segunda
señal, aquella cuya frecuencia
fue determinada
a partir del estudio espectral basado en espacios
monofrecuenciales,
parece ajustarse un poco mejor a la gráfica de $x$. \\

\begin{figure}[H]
			\sidecaption{
			Mostramos ahora los espectros de la señal $x$ que se obtiene
			tomando $36$ muestras uniformemente espaciadas del mismo sinusoide
			$f_{3.4}(t)$, 	
			esta vez sin agregar ruido aleatorio a las mediciones.
			Observe que el espectro-1 detectó a la frecuencia $\omega = 3.4$
			como la mejor, y que el sinusoide naranja ajusta perfectamente la gráfica
			de $x$. Como la frecuencia real no es entera, usar la frecuencia principal
			dada por la TDF sigue sin dar resultados perfectos, aunque no malos.
			\label{fig: sinusoide sin ruido}
			}
			\centering
			\includegraphics[scale = 0.4]{./estudios_espectrales/sinusoide_sin_ruido} 
		\end{figure}		



	\begin{figure}[H]
			\sidecaption{
			Si ahora muestreamos sin ruido
			del sinusoide $f_{5}$,
			como 
			era de esperarse, la frecuencia principal de ambos
			espectros es $5$
			(y el valor de los 
			espectros en tal frecuencia
			es igual a $1$, la cota
			superior). Además, 
			las gráficas de frecuencia $5$ que resultan
			ajustan a la perfección a la señal original $x$.
			\label{fig: comparacion 4}
			}
			\centering
			\includegraphics[scale = 0.4]{coseno_frec_5} 
		\end{figure}	


Para terminar este ejemplo, tomemos una suma de sinusoides
de varias frecuencias, digamos, de frecuencias
$1$, $4$ y $7$; sea
\[
g(t) = 3 sen(2 \pi t) + sen(2 \pi \cdot 4t) + 0.5 cos(2 \pi \cdot 7t).
\]
Sea $x$ la señal que resulta de muestrar, sin ruido, este sinusoide
$g$, siendo $25$ el tamaño de la muestra.
\begin{figure}[H]
	\sidecaption{
	En la imagen se muestran los espectros de tal $x$. Observe que los
	espectros parecen concentrarse alrededor de las 
	frecuencias $1$, $4$ y $7$.
	\label{fig: sin varias frec}
	}
	\centering
	\includegraphics[scale = 0.43]{sinusoide_varias_frecuencias} 
\end{figure}	

\final
\end{ejemplo}

\input{frec_muestreo}